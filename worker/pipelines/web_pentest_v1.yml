stage: web_pentest_v1
tools:
  # Step 1: httpx probe (live targets)
  - name: httpx
    enabled: true
    timeout: 120
    artifact_name: httpx.jsonl

  # Step 2: katana crawl (discovered endpoints)
  - name: katana
    enabled: true
    timeout: 100
    artifact_name: katana_urls.txt
    args:
      depth: 2
      max_urls: 10000

  # Step 3 (optional): ffuf fuzzing/discovery
  - name: ffuf
    enabled: true
    timeout: 100
    artifact_name: ffuf.json
    args:
      threads: 20
      req_timeout: 5
      max_dirs: 200
      # Prevent ffuf -> nuclei fan-out from exploding.
      max_urls_for_nuclei: 200
      include_redirects_downstream: false

  # Step 4: nuclei scan (vulnerabilities)
  - name: nuclei
    enabled: true
    timeout: 600
    artifact_name: nuclei.jsonl
    args:
      # Keep nuclei bounded so it finishes reliably.
      templates: "/opt/nuclei-templates/http/exposures/"
      rate_limit: 20
      timeout: 8
      retries: 1
      concurrency: 10
      max_katana_urls: 1200
      max_ffuf_urls: 200
      max_targets: 1200
      include_raw: false
      stats: true
      stats_interval: 5
      # Speed default: only scan the original target host/port.
      prefer_target_only: true
      max_base_urls: 5
